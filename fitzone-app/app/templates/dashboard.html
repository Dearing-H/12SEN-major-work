<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üèãÔ∏è FITZONE Dashboard</title>

  <style>
    :root {
      --bg: #0f0f0f;
      --card: #1e1e1e;
      --accent: #00e0ff;
      --text: #ffffff;
      --hover: #00bcd4;
      --nav-bg: #161616;
      --active: #00ff99;
    }

    body.light-mode {
      --bg: #ffffff;
      --card: #f4f4f4;
      --accent: #0077cc;
      --text: #000000;
      --hover: #005fa3;
      --nav-bg: #e0e0e0;
      --active: #44c767;
    }
    .theme-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: 2px solid var(--accent);
      padding: 8px 16px;
      border-radius: 6px;
      color: var(--accent);
      font-weight: bold;
      cursor: pointer;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Orbitron', sans-serif;
      background-color: var(--bg);
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }

    .header {
      background: linear-gradient(135deg, var(--nav-bg), var(--card));
      padding: 20px;
      text-align: center;
      border-bottom: 2px solid var(--accent);
      box-shadow: 0 4px 20px rgba(0,224,255,0.3);
    }

    .header h1 {
      color: var(--accent);
      margin-bottom: 20px;
      font-size: 2.5rem;
      text-shadow: 0 0 20px rgba(0,224,255,0.5);
    }

    .nav-menu {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      padding: 10px 0;
    }

    .nav-item {
      background: var(--card);
      border: 2px solid transparent;
      border-radius: 12px;
      padding: 15px 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      min-width: 120px;
      position: relative;
      overflow: hidden;
    }

    .nav-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0,224,255,0.2), transparent);
      transition: left 0.5s;
    }

    .nav-item:hover::before {
      left: 100%;
    }

    .nav-item:hover {
      border-color: var(--accent);
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0,224,255,0.4);
    }

    .nav-item.active {
      border-color: var(--active);
      background: linear-gradient(135deg, var(--card), rgba(0,255,153,0.1));
      box-shadow: 0 8px 25px rgba(0,255,153,0.3);
    }

    .nav-icon {
      font-size: 2rem;
      color: var(--accent);
      transition: color 0.3s ease;
    }

    .nav-item.active .nav-icon {
      color: var(--active);
    }

    .nav-label {
      font-size: 0.9rem;
      font-weight: bold;
      text-align: center;
    }

    .main-container {
      padding: 30px;
      max-width: 1000px;
      margin: 0 auto;
    }

    .quick-stats {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: var(--card);
      flex: 1;
      min-width: 180px;
      padding: 1rem;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0,224,255,0.15);
      font-weight: bold;
      text-align: center;
      color: var(--accent);
    }
    .motivational-quote {
      margin-top: 20px;
      font-size: 1.2rem;
      color: #00ff99;
      font-style: italic;
      text-align: center;
    }

    .content-frame {
      background: var(--card);
      border-radius: 16px;
      padding: 2rem;
      box-shadow: 0 0 30px rgba(0,224,255,0.2);
      border: 1px solid rgba(0,224,255,0.3);
      min-height: 500px;
      position: relative;
      overflow: hidden;
    }

    .content-frame::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--accent), var(--active), var(--accent));
      border-radius: 16px 16px 0 0;
    }

    .section {
      display: none;
      animation: fadeIn 0.5s ease-in-out;
    }

    .section.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      margin-bottom: 1.5rem;
      color: var(--accent);
      font-size: 1.8rem;
      text-align: center;
      text-shadow: 0 0 10px rgba(0,224,255,0.5);
    }

    .form-group {
      margin-bottom: 1rem;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      color: var(--text);
      font-weight: bold;
    }

    input, textarea, select {
      width: 100%;
      padding: 12px;
      background: #2b2b2b;
      border: 2px solid transparent;
      border-radius: 8px;
      color: var(--text);
      font-size: 1rem;
      transition: border-color 0.3s ease;
      box-shadow: 0 1px 2px rgba(0,0,0,0.10);
    }
    input:hover, textarea:hover, select:hover {
      box-shadow: 0 0 8px rgba(0,224,255,0.2);
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 10px rgba(0,224,255,0.3);
    }

    button {
      width: 100%;
      padding: 12px;
      background: linear-gradient(135deg, var(--accent), var(--hover));
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: bold;
      color: #000;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 1rem;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,224,255,0.4);
    }

    .result {
      margin-top: 1rem;
      padding: 15px;
      background: rgba(0,224,255,0.1);
      border-radius: 8px;
      border-left: 4px solid var(--accent);
      font-weight: bold;
      font-size: 1.1rem;
    }

    ul {
      list-style: none;
      margin-top: 1rem;
    }

    ul li {
      background: rgba(0,255,153,0.1);
      margin: 8px 0;
      padding: 12px;
      border-radius: 6px;
      border-left: 3px solid var(--active);
    }

    canvas {
      background: #111;
      border-radius: 8px;
      width: 100%;
      margin-top: 1rem;
    }

    #tooltip {
      position: fixed;
      background: rgba(0, 0, 0, 0.9);
      color: var(--active);
      padding: 8px 12px;
      border-radius: 6px;
      pointer-events: none;
      font-family: monospace;
      font-size: 0.9rem;
      transition: opacity 0.3s;
      z-index: 1000;
      border: 1px solid var(--active);
    }

    .welcome-section {
      text-align: center;
      padding: 40px 20px;
    }

    .welcome-section h2 {
      font-size: 2.5rem;
      margin-bottom: 20px;
      background: linear-gradient(135deg, var(--accent), var(--active));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .welcome-section p {
      font-size: 1.2rem;
      opacity: 0.8;
      line-height: 1.6;
    }

    .two-column {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-top: 1rem;
    }

    @media (max-width: 768px) {
      .nav-menu {
        gap: 10px;
      }
      
      .nav-item {
        min-width: 100px;
        padding: 12px 15px;
      }
      
      .nav-icon {
        font-size: 1.5rem;
      }
      
      .nav-label {
        font-size: 0.8rem;
      }

      .two-column {
        grid-template-columns: 1fr;
      }
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
  <script src="https://unpkg.com/konva@9.3.13/konva.min.js"></script>
</head>
<body>
  <header class="header" style="position: relative;">
    <h1>üèãÔ∏è FITZONE Dashboard</h1>
    <button onclick="toggleTheme()" class="theme-toggle">üåó Toggle Theme</button>
    <nav class="nav-menu">
      <div class="nav-item active" onclick="showSection('welcome')">
        <div class="nav-icon">üè†</div>
        <div class="nav-label">Home</div>
      </div>
      <div class="nav-item" onclick="showSection('bmi')">
        <div class="nav-icon">‚öñÔ∏è</div>
        <div class="nav-label">BMI</div>
      </div>
      <div class="nav-item" onclick="showSection('calories')">
        <div class="nav-icon">üî•</div>
        <div class="nav-label">Calories</div>
      </div>
      <div class="nav-item" onclick="showSection('reps')">
        <div class="nav-icon">üí™</div>
        <div class="nav-label">Rep Tracker</div>
      </div>
      <div class="nav-item" onclick="showSection('meals')">
        <div class="nav-icon">üçΩÔ∏è</div>
        <div class="nav-label">Meals</div>
      </div>
      <div class="nav-item" onclick="showSection('goals')">
        <div class="nav-icon">üéØ</div>
        <div class="nav-label">Goals</div>
      </div>
      <div class="nav-item" onclick="showSection('workout')">
        <div class="nav-icon">üìÖ</div>
        <div class="nav-label">Workout</div>
      </div>
      <div class="nav-item" onclick="showSection('water')">
        <div class="nav-icon">üíß</div>
        <div class="nav-label">Water</div>
      </div>
      <div class="nav-item" onclick="showSection('progress')">
        <div class="nav-icon">üìä</div>
        <div class="nav-label">Progress</div>
      </div>
      <div class="nav-item" onclick="showSection('muscles')">
        <div class="nav-icon">üèãÔ∏è</div>
        <div class="nav-label">Muscles</div>
      </div>
      <!-- About nav item -->
      <div class="nav-item" onclick="showSection('about')">
        <div class="nav-icon">‚ÑπÔ∏è</div>
        <div class="nav-label">About</div>
      </div>
      <!-- Logout button -->
      <div class="nav-item" onclick="window.location.href='{{ url_for('logout') }}'">
        <div class="nav-icon">üö™</div>
        <div class="nav-label">Logout</div>
      </div>
    </nav>
  </header>

  <main class="main-container">
    <div class="quick-stats">
      <div class="stat-card">üë§ User: <strong>{{ user.username }}</strong></div>
      <div class="stat-card">‚öñÔ∏è BMI: <strong>{{ user.bmi or 'N/A' }}</strong></div>
      <div class="stat-card">üî• TDEE: <strong>{{ user.tdee or 'N/A' }} kcal</strong></div>
      <div class="stat-card">üéØ Goal: <strong>{{ user.goal_weight or 'N/A' }} kg</strong></div>
    </div>
    <div class="content-frame">
      <!-- Welcome Section -->
      <section id="welcome" class="section active">
        <div class="welcome-section">
          <h2>Welcome to FITZONE</h2>
          <p>Your ultimate fitness companion! Select any tool from the menu above to track your progress, plan your workouts, and achieve your fitness goals.</p>
          <p>Get started by clicking on one of the icons above to access different features.</p>
        </div>
        <div class="motivational-quote">
          ‚ÄúDon‚Äôt count the days. Make the days count.‚Äù ‚Äì Muhammad Ali
        </div>
      </section>

      <!-- BMI Section -->
      <section id="bmi" class="section">
        <h2>BMI Checker</h2>
        <div class="two-column">
          <div>
            <form id="bmi-form" method="post">
              <div class="form-group">
                <label for="weight">Weight (kg):</label>
                <input type="number" step="0.1" id="weight" name="weight" value="{{ user.weight or '' }}" required placeholder="e.g., 70.5" aria-label="Weight in kilograms" />
                <small>Use decimal format (e.g., 70.5)</small>
              </div>
              <div class="form-group">
                <label for="height">Height (cm):</label>
                <input type="number" step="0.1" id="height" name="height" value="{{ user.height or '' }}" required placeholder="e.g., 175.0" aria-label="Height in centimeters" />
                <small>Use decimal format (e.g., 175.0)</small>
              </div>
              <button type="submit" name="bmi_submit">Save &amp; Calculate BMI ‚ûï</button>
            </form>
            <button onclick="calculateBMI()">Calculate BMI ‚ûï</button>
          </div>
          <div>
            <div id="bmi-result" class="result" style="margin-top: 1rem;">
              {% if user.bmi %}
                Your last saved BMI is <strong>{{ user.bmi }}</strong>.
              {% else %}
                Enter your details to calculate BMI.
              {% endif %}
            </div>
          </div>
        </div>
      </section>

      <!-- Calories Section -->
      <section id="calories" class="section">
        <h2>Daily Calorie Calculator</h2>
        <div class="two-column">
          <div>
            <form method="POST">
              <div class="form-group">
                <label for="cal-age">Age</label>
                <input type="number" id="cal-age" name="age" value="{{ user.age or '' }}" placeholder="Enter your age" min="0" required aria-label="Age in years" />
              </div>
              <div class="form-group">
                <label for="cal-weight">Weight (kg)</label>
                <input type="number" id="cal-weight" name="c_weight" value="{{ user.weight or '' }}" placeholder="e.g., 70.5" min="0" step="0.1" required aria-label="Weight in kilograms" />
                <small>Use decimal format (e.g., 70.5)</small>
              </div>
              <div class="form-group">
                <label for="cal-height">Height (cm)</label>
                <input type="number" id="cal-height" name="c_height" value="{{ user.height or '' }}" placeholder="e.g., 175.0" min="0" step="0.1" required aria-label="Height in centimeters" />
                <small>Use decimal format (e.g., 175.0)</small>
              </div>
              <div class="form-group">
                <label for="cal-activity">Activity Level</label>
                <select id="cal-activity" name="activity" required aria-label="Activity Level">
                  <option value="1.2" {% if user.activity_level == 1.2 %}selected{% endif %}>Sedentary</option>
                  <option value="1.375" {% if user.activity_level == 1.375 %}selected{% endif %}>Lightly active</option>
                  <option value="1.55" {% if user.activity_level == 1.55 %}selected{% endif %}>Moderately active</option>
                  <option value="1.725" {% if user.activity_level == 1.725 %}selected{% endif %}>Very active</option>
                  <option value="1.9" {% if user.activity_level == 1.9 %}selected{% endif %}>Extra active</option>
                </select>
                <small>Select based on your average daily activity</small>
              </div>
              <button type="submit" name="calorie_submit">Save Calories üçΩÔ∏è</button>
            </form>
            <button onclick="calculateCalories()">Calculate TDEE üî•</button>
          </div>
          <div>
            <div class="result" id="cal-result" style="margin-top: 1rem;">
              {% if user.tdee %}
                Your last calculated daily requirement is <strong>{{ user.tdee }} kcal</strong>.
              {% else %}
                Enter your details to calculate daily calories.
              {% endif %}
            </div>
          </div>
        </div>
      </section>

      <!-- Rep Tracker Section -->
      <section id="reps" class="section">
        <h2>Rep Tracker</h2>
        <div class="two-column">
          <div>
            <form method="POST">
              <div class="form-group">
                <label for="exercise-name">Exercise</label>
                <input type="text" id="exercise-name" name="exercise" value="{{ user.last_exercise_name or '' }}" placeholder="e.g., Push-ups" required aria-label="Exercise name" />
                <small>Enter the exercise name (e.g., Push-ups)</small>
              </div>
              <div class="form-group">
                <label for="reps-count">Reps</label>
                <input type="number" id="reps-count" name="reps" value="{{ user.last_reps or '' }}" placeholder="e.g., 12" min="0" required aria-label="Number of reps" />
                <small>How many repetitions per set?</small>
              </div>
              <div class="form-group">
                <label for="sets-count">Sets</label>
                <input type="number" id="sets-count" name="sets" value="{{ user.last_sets or '' }}" placeholder="e.g., 3" min="0" required aria-label="Number of sets" />
                <small>How many sets?</small>
              </div>
              <button type="submit" name="exercise_submit">Log Exercise üèãÔ∏è</button>
            </form>
          </div>
          <div>
            <h3 style="color: var(--accent); margin-bottom: 1rem;">Recent Exercise Log</h3>
            <ul id="reps-log">
              {% for log in exercise_logs %}
                <li>{{ log.exercise_name }}: {{ log.sets }} sets √ó {{ log.reps }} reps = {{ log.total_reps }} total reps</li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </section>

      <!-- Meals Section -->
      <section id="meals" class="section">
        <h2>Meal Tracker</h2>
        <div class="two-column">
          <div>
            <form method="POST">
              <div class="form-group">
                <label for="meal">Meal Description</label>
                <textarea id="meal" name="meal" placeholder="e.g., Grilled chicken, rice &amp; veggies" rows="4" required aria-label="Meal description">{{ user.last_meal_description or '' }}</textarea>
                <small>Example: ‚ÄúGrilled chicken, rice &amp; veggies‚Äù</small>
              </div>
              <button type="submit" name="meal_submit">Log Meal üç¥</button>
            </form>
          </div>
          <div>
            <h3 style="color: var(--accent); margin-bottom: 1rem;">Today's Meals</h3>
            <ul id="meal-log">
              {% for log in meal_logs %}
                <li><strong>{{ log.timestamp.strftime('%Y-%m-%d %H:%M') }}:</strong> {{ log.meal_description }}</li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </section>

      <!-- Weight Goals Section -->
      <section id="goals" class="section">
        <h2>Weight Goals Tracker</h2>
        <div class="two-column">
          <div>
            <form method="POST">
              <div class="form-group">
                <label for="current-weight">Current Weight (kg)</label>
                <input type="number" id="current-weight" name="current_weight" value="{{ user.current_weight or '' }}" placeholder="e.g., 80.0" min="0" step="0.1" required aria-label="Current weight in kilograms" />
                <small>Use decimal format (e.g., 80.0)</small>
              </div>
              <div class="form-group">
                <label for="goal-weight">Goal Weight (kg)</label>
                <input type="number" id="goal-weight" name="goal_weight" value="{{ user.goal_weight or '' }}" placeholder="e.g., 75.0" min="0" step="0.1" required aria-label="Goal weight in kilograms" />
                <small>Use decimal format (e.g., 75.0)</small>
              </div>
              <button type="submit" name="goal_submit">Save Goal üéØ</button>
            </form>
          </div>
          <div>
            <div class="result" id="goal-result" style="margin-top: 1rem;">
              {% if user.goal_weight and user.current_weight %}
                Your goal is <strong>{{ user.goal_weight }} kg</strong>. You are currently <strong>{{ user.current_weight }} kg</strong>.
              {% else %}
                Set your current and goal weight to track progress.
              {% endif %}
            </div>
          </div>
        </div>
      </section>

      <!-- Workout Plan Section -->
      <section id="workout" class="section">
        <h2>Weekly Workout Plan</h2>
        <div class="form-group">
          <label for="day-select">Select Day</label>
          <select id="day-select" onchange="showPlan()">
            <option>Monday</option>
            <option>Tuesday</option>
            <option>Wednesday</option>
            <option>Thursday</option>
            <option>Friday</option>
          </select>
        </div>
        <div class="result" id="plan-output">Select a day to view your workout plan</div>
      </section>

      <!-- Water Tracker Section -->
      <section id="water" class="section">
        <h2>Water Intake Tracker</h2>
        <div class="two-column">
          <div>
            <form method="POST" onsubmit="event.preventDefault(); logWater();">
              <div class="form-group">
                <label for="water-intake">Cups of Water Today</label>
                <input type="number" id="water-intake" name="cups" placeholder="e.g., 1 cup = 250ml" min="0" required aria-label="Cups of water today" />
                <small>1 cup ‚âà 250ml. Log every drink!</small>
              </div>
              <button type="submit">Log Water üíß</button>
            </form>
            <div class="result" style="margin-top: 1rem;" id="hydration-tips">
              üí° Tip: Most adults need around 8‚Äì10 cups of water per day. Adjust based on your activity level!
            </div>
          </div>
          <div>
            <div class="result" id="water-result" style="margin-top: 1rem;">
              <h3 style="color: var(--accent); margin-bottom: 1rem;">Today's Water Log</h3>
              <ul id="water-log"></ul>
              <div id="hydration-status" style="margin-top: 1rem;"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Progress Chart Section -->
      <section id="progress" class="section">
        <h2>Progress Chart</h2>
        <div class="form-group">
          <label for="progress-range">Time Range</label>
          <select id="progress-range" onchange="updateProgressChart()">
            <option value="week">This Week</option>
            <option value="month">This Month</option>
          </select>
        </div>
        <div class="two-column">
          <div>
            <canvas id="progressChart" width="400" height="300"></canvas>
            <div class="result" style="background: #0d1b2a; color: #00e0ff; border-left: 4px solid #00e0ff;">
              <strong>Performance Summary:</strong><br />
              You've increased reps by 150 since Week 1!<br />
              You've lost 3 kg ‚Äì great job!
            </div>
            <div style="margin-top: 1rem; color: var(--text); font-weight: bold;">üèãÔ∏è Reps today: 0</div>
          </div>
          <div>
            <canvas id="nutritionChart" width="400" height="300"></canvas>
          </div>
        </div>
      </section>

      <!-- Muscle Focus Section (SVG Interactive) -->
      <section id="muscles" class="section">
        <h2>Muscle Focus Viewer</h2>
        <style>
          .muscle-svg-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: flex-start;
            gap: 2rem;
            margin-top: 1.5rem;
          }
          .svg-human-diagram {
            width: 320px;
            max-width: 100vw;
            height: 480px;
            display: block;
            background: #181818;
            border-radius: 16px;
            box-shadow: 0 0 24px rgba(0,224,255,0.12);
          }
          .muscle-group {
            cursor: pointer;
            transition: fill 0.25s, stroke 0.25s;
            stroke: #00e0ff;
            stroke-width: 0;
          }
          .muscle-group[data-active="true"] {
            fill: #00ff99 !important;
            stroke: #00e0ff;
            stroke-width: 2;
            filter: drop-shadow(0 0 6px #00ff99aa);
          }
          .muscle-group[data-selected="true"] {
            fill: #ffb703 !important;
            stroke: #ffb703;
            stroke-width: 3;
            filter: drop-shadow(0 0 8px #ffb703cc);
          }
          .muscle-group[data-focused="true"] {
            fill: #00e0ff !important;
            stroke: #00e0ff;
            stroke-width: 4;
            filter: drop-shadow(0 0 12px #00e0ffcc);
          }
          .muscle-panel {
            background: var(--card);
            border-radius: 12px;
            min-width: 240px;
            max-width: 320px;
            padding: 1rem 1.5rem;
            color: var(--text);
            box-shadow: 0 0 16px rgba(0,224,255,0.08);
            border: 1px solid var(--accent);
          }
          .muscle-panel h3 {
            color: var(--active);
            margin-bottom: 0.5rem;
            font-size: 1.3rem;
          }
          .muscle-panel ul {
            margin: 0.5rem 0 0 0;
            padding-left: 1.25rem;
            color: var(--text);
            font-size: 1rem;
          }
          .muscle-panel .desc {
            color: #b2f7ef;
            font-size: 1.05rem;
            margin-bottom: 0.75rem;
          }
        </style>
        <div style="text-align:center; margin-bottom:12px;">
          <span style="font-size:1.2rem; color:var(--active); font-weight:bold;">Visualize Your Target Muscles</span>
        </div>
        <p style="text-align: center; margin-bottom: 18px;">Select a workout day to see targeted muscle groups. Click a muscle for details!</p>
        <div class="form-group" style="max-width: 300px; margin: 0 auto 1rem auto;">
          <label for="muscle-day-select">Select Day</label>
          <select id="muscle-day-select">
            <option>Monday</option>
            <option>Tuesday</option>
            <option>Wednesday</option>
            <option>Thursday</option>
            <option>Friday</option>
          </select>
        </div>
        <div class="muscle-svg-container">
          <svg class="svg-human-diagram" viewBox="0 0 240 360" xmlns="http://www.w3.org/2000/svg">
            <!-- Arms (background) -->
            <ellipse cx="60" cy="90" rx="24" ry="48" fill="#333" />
            <ellipse cx="180" cy="90" rx="24" ry="48" fill="#333" />
            <!-- Shoulders -->
            <ellipse class="muscle-group" id="shoulders" data-muscle="shoulders" cx="60" cy="62" rx="18" ry="18" fill="#444" />
            <ellipse class="muscle-group" id="shoulders-r" data-muscle="shoulders" cx="180" cy="62" rx="18" ry="18" fill="#444" />
            <!-- Biceps -->
            <ellipse class="muscle-group" id="biceps" data-muscle="biceps" cx="60" cy="100" rx="13" ry="22" fill="#444" />
            <ellipse class="muscle-group" id="biceps-r" data-muscle="biceps" cx="180" cy="100" rx="13" ry="22" fill="#444" />
            <!-- Triceps -->
            <ellipse class="muscle-group" id="triceps" data-muscle="triceps" cx="60" cy="140" rx="13" ry="20" fill="#444" />
            <ellipse class="muscle-group" id="triceps-r" data-muscle="triceps" cx="180" cy="140" rx="13" ry="20" fill="#444" />
            <!-- Chest -->
            <ellipse class="muscle-group" id="chest" data-muscle="chest" cx="120" cy="80" rx="38" ry="24" fill="#444" />
            <!-- Core (abs) -->
            <rect class="muscle-group" id="core" data-muscle="core" x="96" y="110" width="48" height="60" rx="16" fill="#444" />
            <!-- Back (upper) -->
            <rect class="muscle-group" id="back" data-muscle="back" x="80" y="170" width="80" height="34" rx="16" fill="#444" />
            <!-- Quads -->
            <rect class="muscle-group" id="quads" data-muscle="quads" x="97" y="210" width="22" height="60" rx="10" fill="#444" />
            <rect class="muscle-group" id="quads-r" data-muscle="quads" x="121" y="210" width="22" height="60" rx="10" fill="#444" />
            <!-- Calves -->
            <rect class="muscle-group" id="calves" data-muscle="calves" x="99" y="272" width="16" height="40" rx="8" fill="#444" />
            <rect class="muscle-group" id="calves-r" data-muscle="calves" x="125" y="272" width="16" height="40" rx="8" fill="#444" />
            <!-- Outline/body -->
            <ellipse cx="120" cy="50" rx="30" ry="30" fill="#222" />
            <rect x="90" y="80" width="60" height="180" rx="28" fill="#222" />
            <rect x="97" y="260" width="22" height="56" rx="10" fill="#222" />
            <rect x="121" y="260" width="22" height="56" rx="10" fill="#222" />
          </svg>
          <div class="muscle-panel" id="muscle-panel">
            <h3>Muscle Group Info</h3>
            <div class="desc">Select a muscle to see details, tips, and exercises.</div>
            <div id="muscle-details">
              <strong>Tip:</strong> Choose a workout day to highlight your focus areas.
            </div>
          </div>
        </div>
        <script>
        // Muscle group data (name, description, exercises)
        const muscleData = {
          chest: {
            name: "Chest",
            desc: "The pectoral muscles are responsible for pushing movements.",
            exercises: ["Bench Press", "Push-ups", "Chest Fly", "Incline Press"]
          },
          back: {
            name: "Back",
            desc: "The back muscles support pulling and posture.",
            exercises: ["Deadlifts", "Pull-ups", "Barbell Rows", "Lat Pulldown"]
          },
          biceps: {
            name: "Biceps",
            desc: "Biceps are used for curling and pulling movements.",
            exercises: ["Bicep Curls", "Chin-ups", "Hammer Curl"]
          },
          triceps: {
            name: "Triceps",
            desc: "Triceps are key for extending the arm.",
            exercises: ["Tricep Dips", "Overhead Extension", "Close-grip Bench"]
          },
          shoulders: {
            name: "Shoulders",
            desc: "Deltoids help with lifting and overhead movements.",
            exercises: ["Overhead Press", "Lateral Raise", "Front Raise"]
          },
          core: {
            name: "Core",
            desc: "Core muscles stabilize the body and support balance.",
            exercises: ["Planks", "Crunches", "Russian Twist", "Leg Raise"]
          },
          quads: {
            name: "Quads",
            desc: "Quadriceps power knee extension and squatting.",
            exercises: ["Squats", "Lunges", "Leg Press"]
          },
          calves: {
            name: "Calves",
            desc: "Calf muscles are important for ankle movement and stability.",
            exercises: ["Calf Raises", "Jump Rope", "Seated Calf Press"]
          }
        };
        // Day-to-muscle mapping
        const dayToMuscles = {
          Monday: ['chest', 'triceps', 'shoulders'],
          Tuesday: ['back', 'biceps'],
          Wednesday: ['quads', 'calves'],
          Thursday: ['core', 'chest', 'back'],
          Friday: ['shoulders', 'core', 'quads', 'biceps']
        };
        // All SVG muscle elements (grouped by main muscle)
        const muscleSvgIds = {
          chest: ['chest'],
          back: ['back'],
          biceps: ['biceps', 'biceps-r'],
          triceps: ['triceps', 'triceps-r'],
          shoulders: ['shoulders', 'shoulders-r'],
          core: ['core'],
          quads: ['quads', 'quads-r'],
          calves: ['calves', 'calves-r']
        };
        let selectedMuscle = null;
        // Helper: set attribute for all SVG elements of a muscle
        function setMuscleAttr(muscle, attr, value) {
          (muscleSvgIds[muscle]||[]).forEach(id => {
            const el = document.getElementById(id);
            if (el) el.setAttribute(attr, value);
          });
        }
        // Helper: clear all highlight attrs
        function clearMuscleAttrs() {
          Object.keys(muscleSvgIds).forEach(m => {
            setMuscleAttr(m, 'data-active', 'false');
            setMuscleAttr(m, 'data-selected', 'false');
            setMuscleAttr(m, 'data-focused', 'false');
          });
        }
        // Highlight muscles for selected day
        function highlightMusclesSVG(day) {
          clearMuscleAttrs();
          // Highlight today's focus
          (dayToMuscles[day]||[]).forEach(m => setMuscleAttr(m, 'data-active', 'true'));
          // If a muscle is selected, keep it highlighted as selected/focused
          if (selectedMuscle) {
            setMuscleAttr(selectedMuscle, 'data-selected', 'true');
            setMuscleAttr(selectedMuscle, 'data-focused', 'true');
          }
        }
        // Update muscle info panel
        function showMusclePanel(muscle) {
          const panel = document.getElementById('muscle-panel');
          const details = document.getElementById('muscle-details');
          if (!muscleData[muscle]) {
            details.innerHTML = `<strong>Tip:</strong> Choose a workout day to highlight your focus areas.`;
            panel.querySelector('h3').textContent = 'Muscle Group Info';
            panel.querySelector('.desc').textContent = 'Select a muscle to see details, tips, and exercises.';
            return;
          }
          const d = muscleData[muscle];
          panel.querySelector('h3').textContent = d.name;
          panel.querySelector('.desc').textContent = d.desc;
          details.innerHTML = `<strong>Sample Exercises:</strong><ul>` +
            d.exercises.map(e => `<li>${e}</li>`).join('') +
            `</ul>`;
        }
        // Setup listeners
        document.addEventListener('DOMContentLoaded', function() {
          // Initial highlight
          const selDay = document.getElementById('muscle-day-select');
          highlightMusclesSVG(selDay.value);
          // Day selector
          selDay.addEventListener('change', function() {
            highlightMusclesSVG(this.value);
            // If selected muscle is not on this day's focus, keep it highlighted
          });
          // Click handlers for muscles
          Object.keys(muscleSvgIds).forEach(muscle => {
            (muscleSvgIds[muscle]||[]).forEach(id => {
              const el = document.getElementById(id);
              if (!el) return;
              el.addEventListener('click', function() {
                // Deselect previous
                selectedMuscle = muscle;
                highlightMusclesSVG(selDay.value);
                showMusclePanel(muscle);
              });
              el.addEventListener('mouseenter', function() {
                setMuscleAttr(muscle, 'data-focused', 'true');
              });
              el.addEventListener('mouseleave', function() {
                // Only remove if not selected
                if (selectedMuscle !== muscle)
                  setMuscleAttr(muscle, 'data-focused', 'false');
              });
            });
          });
          // On initial load, show default panel
          showMusclePanel(null);
        });
        </script>
      </section>

      <!-- About Section -->
      <section id="about" class="section">
        <h2>About FITZONE</h2>
        <p style="line-height:1.6;">Fitzone is your AI-powered training dashboard. Track your workouts, monitor BMI and calories, log meals and hydration, and focus on targeted muscle development. Designed with best practices in fitness tech.</p>
        <p style="margin-top:20px;">Inspired by: MyFitnessPal, Strong App, Fitbod.</p>
      </section>

      <!-- <form action="{{ url_for('logout') }}">
        <button type="submit" style="background-color: #d63031; color: #fff;">Logout</button>
      </form> -->
    </div>
  </main>

  <script>
    // Navigation functionality
    function showSection(sectionId) {
      // Hide all sections
      document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
      });

      // Remove active class from all nav items
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });

      // Show selected section
      const section = document.getElementById(sectionId);
      if (section) {
        section.classList.add('active');
      } else {
        console.error(`Section with ID ${sectionId} not found`);
        return;
      }

      // Add active class to clicked nav item
      const navItem = event.target.closest('.nav-item');
      if (navItem) {
        navItem.classList.add('active');
      }

      // Initialize specific sections
      try {
        if (sectionId === 'progress' && !chart) {
          initProgressChart();
        } else if (sectionId === 'muscles' && !stage) {
          initMuscleViewer();
        } else if (sectionId === 'workout') {
          showPlan();
        }
      } catch (error) {
        console.error(`Error initializing section ${sectionId}:`, error);
      }
    }

    // BMI Calculator
    function calculateBMI() {
      const w = parseFloat(document.getElementById('weight').value);
      const h = parseFloat(document.getElementById('height').value) / 100;
      const resultDiv = document.getElementById('bmi-result');
      
      if (!w || !h || w <= 0 || h <= 0) {
        resultDiv.textContent = 'Please enter valid weight and height values';
        return;
      }
      
      const bmi = (w / (h * h)).toFixed(2);
      let status = bmi < 18.5 ? 'Underweight' :
                   bmi < 25 ? 'Normal Weight' :
                   bmi < 30 ? 'Overweight' : 'Obese';
      let color = bmi < 18.5 ? '#ff6b6b' :
                  bmi < 25 ? '#51cf66' :
                  bmi < 30 ? '#ffd43b' : '#ff6b6b';
      
      resultDiv.innerHTML = `
        <div style="color: ${color};">Your BMI is <strong>${bmi}</strong></div>
        <div>Category: <strong>${status}</strong></div>
      `;
    }

    // Calorie Calculator
    function calculateCalories() {
      const age = parseFloat(document.getElementById('cal-age').value);
      const w = parseFloat(document.getElementById('cal-weight').value);
      const h = parseFloat(document.getElementById('cal-height').value);
      const act = parseFloat(document.getElementById('cal-activity').value);
      const resultDiv = document.getElementById('cal-result');
      
      if (!age || !w || !h || age <= 0 || w <= 0 || h <= 0) {
        resultDiv.textContent = 'Please enter valid age, weight, and height';
        return;
      }
      
      const bmr = 10 * w + 6.25 * h - 5 * age + 5;
      const tdee = Math.round(bmr * act);
      const goal = tdee > 2500 ? 'Consider cutting calories for weight loss' :
                   tdee < 2000 ? 'Consider increasing calories for weight gain' :
                   'Maintain current intake for weight maintenance';
      
      resultDiv.innerHTML = `
        <div>Daily Calories (TDEE): <strong>${tdee} kcal</strong></div>
        <div style="margin-top: 10px;">${goal}</div>
      `;
    }

    // Progress Chart Variables
    const labels = [], repsArr = [], weightArr = [];
    let chart;

    function initProgressChart() {
      const canvas = document.getElementById('progressChart');
      if (!canvas || chart) return;

      const ctx = canvas.getContext('2d');
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
          datasets: [
            {
              label: 'üèãÔ∏è Exercise',
              data: [100, 150, 180, 230],
              borderColor: '#00b4d8',
              backgroundColor: 'rgba(0,180,216,0.1)',
              tension: 0.3,
              fill: true,
              pointBackgroundColor: '#fff',
              pointRadius: 6
            },
            {
              label: '‚öñÔ∏è Weight',
              data: [80, 77, 77, 76],
              borderColor: '#ef476f',
              backgroundColor: 'rgba(239,71,111,0.1)',
              tension: 0.3,
              fill: true,
              pointBackgroundColor: '#fff',
              pointRadius: 6
            }
          ]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { labels: { color: '#fff' } },
            title: {
              display: true,
              text: 'Progress Overview (Exercise vs Weight)',
              color: '#00e0ff'
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: { color: '#ffffff' },
              grid: { color: 'rgba(255,255,255,0.1)' }
            },
            x: {
              ticks: { color: '#ffffff' },
              grid: { color: 'rgba(255,255,255,0.1)' }
            }
          }
        }
      });

      const nutCtx = document.getElementById('nutritionChart').getContext('2d');
      new Chart(nutCtx, {
        type: 'doughnut',
        data: {
          labels: ['Protein', 'Carbs', 'Fats'],
          datasets: [{
            label: 'Nutrition Breakdown',
            data: [30, 40, 30],
            backgroundColor: ['#48cae4', '#80ed99', '#ffb703'],
            borderWidth: 2
          }]
        },
        options: {
          plugins: {
            legend: {
              labels: { color: '#fff' }
            },
            title: {
              display: true,
              text: 'Nutrition Breakdown',
              color: '#ffffff'
            }
          }
        }
      });
    }

    // Rep Tracker
    function logReps() {
      const ex = document.getElementById('exercise-name').value.trim();
      const r = parseInt(document.getElementById('reps-count').value);
      const s = parseInt(document.getElementById('sets-count').value);
      
      if (!ex || !r || !s || r <= 0 || s <= 0) {
        alert('Please enter a valid exercise name and positive numbers for reps and sets');
        return;
      }
      
      document.getElementById('reps-log').innerHTML += `<li>${ex}: ${s} sets √ó ${r} reps = ${s * r} total reps</li>`;
      labels.push(ex);
      repsArr.push(r * s);
      weightArr.push(null);
      if (chart) chart.update();
      
      document.getElementById('exercise-name').value = '';
      document.getElementById('reps-count').value = '';
      document.getElementById('sets-count').value = '';
    }

    // Meal Tracker
    function logMeal() {
      const meal = document.getElementById('meal').value.trim();
      if (!meal) {
        alert('Please enter a meal description');
        return;
      }
      
      const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      document.getElementById('meal-log').innerHTML += `<li><strong>${time}</strong>: ${meal}</li>`;
      document.getElementById('meal').value = '';
    }

    // Weight Goals
    function checkGoal() {
      const current = parseFloat(document.getElementById('current-weight').value);
      const goal = parseFloat(document.getElementById('goal-weight').value);
      const resultDiv = document.getElementById('goal-result');
      
      if (!current || !goal || current <= 0 || goal <= 0) {
        resultDiv.textContent = 'Please enter valid current and goal weights';
        return;
      }
      
      const diff = Math.abs(current - goal);
      const msg = current > goal ?
        `You need to lose ${diff.toFixed(1)} kg to reach your goal` :
        current < goal ?
        `You need to gain ${diff.toFixed(1)} kg to reach your goal` :
        'Congratulations! You\'re at your goal weight!';
      
      resultDiv.innerHTML = `
        <div><strong>${msg}</strong></div>
        <div style="margin-top: 10px;">Current: ${current} kg | Goal: ${goal} kg</div>
      `;
      
      labels.push('Weight Goal');
      repsArr.push(null);
      weightArr.push(goal);
      if (chart) chart.update();
    }

    // Workout Plans
    // Future Feature Ideas:
    // - Sync with wearable data
    // - AI-generated training plans
    // - Community leaderboard integration
    // - Dynamic progress prediction with ML

    const plans = {
      Monday: 'Push Day: Bench Press, Shoulder Press, Tricep Dips. üèãÔ∏è‚Äç‚ôÇÔ∏è Focus: Strength<br>Suggested Rest: 1 min between sets<br>Tags: <span style="color:#00ff99;">Strength</span>',
      Tuesday: 'Pull Day: Deadlifts, Pull-ups, Barbell Rows, Bicep Curls. üèãÔ∏è‚Äç‚ôÇÔ∏è Focus: Strength<br>Suggested Rest: 90 sec<br>Tags: <span style="color:#00ff99;">Strength</span>',
      Wednesday: 'Leg Day: Squats, Lunges, Calf Raises, Leg Press. üèÉ‚Äç‚ôÇÔ∏è Focus: Strength & Mobility<br>Suggested Rest: 2 min<br>Tags: <span style="color:#00ff99;">Strength</span>, <span style="color:#ffd43b;">Mobility</span>',
      Thursday: 'HIIT & Core: Burpees, Mountain Climbers, Planks, Russian Twists. üèÉ‚Äç‚ôÇÔ∏è Focus: Cardio<br>Suggested Rest: 30 sec<br>Tags: <span style="color:#2196f3;">Cardio</span>, <span style="color:#ffd43b;">Mobility</span>',
      Friday: 'Full Body: Kettlebell Swings, Jump Squats, Battle Ropes, Thrusters. üí™ Focus: Strength & Cardio<br>Suggested Rest: 1 min<br>Tags: <span style="color:#00ff99;">Strength</span>, <span style="color:#2196f3;">Cardio</span>'
    };

    function showPlan() {
      const daySelect = document.getElementById('day-select');
      if (!daySelect) return;
      
      const day = daySelect.value;
      const planOutput = document.getElementById('plan-output');
      
      if (!plans[day]) {
        planOutput.textContent = 'No workout plan available for this day';
        return;
      }
      
      planOutput.innerHTML = `
        <div><strong>${day} Workout:</strong></div>
        <div style="margin-top: 10px;">${plans[day]}</div>
      `;
    }

    // Water Tracker
    function logWater() {
      const cupsInput = document.getElementById('water-intake');
      const cups = parseInt(cupsInput.value);
      const logList = document.getElementById('water-log');
      const statusDiv = document.getElementById('hydration-status');

      if (isNaN(cups) || cups <= 0) {
        statusDiv.innerHTML = `<div style="color: #ff6b6b;">‚ùå Please enter a valid number of cups</div>`;
        return;
      }

      const timeStr = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      const entry = document.createElement('li');
      entry.innerHTML = `<strong>${timeStr}</strong>: ${cups} cup${cups > 1 ? 's' : ''}`;
      logList.appendChild(entry);

      let total = 0;
      for (const li of logList.children) {
        const match = li.textContent.match(/(\d+)\s+cup/);
        if (match) total += parseInt(match[1]);
      }

      const percentage = Math.min((total / 8) * 100, 100);
      let statusMsg = '';
      if (total >= 8) {
        statusMsg = '‚úÖ Hydration Goal Met! üíß Keep it up!';
      } else if (total >= 6) {
        statusMsg = 'üü° Almost there! Just a little more.';
      } else {
        statusMsg = 'üî¥ Low intake. Drink more water!';
      }

      statusDiv.innerHTML = `
        <div><strong>Total Water: ${total} cups</strong></div>
        <div>Progress: ${percentage.toFixed(1)}%</div>
        <div>${statusMsg}</div>
      `;

      cupsInput.value = '';
    }


    // Initialize workout plan on page load
    document.addEventListener('DOMContentLoaded', function() {
      const hash = window.location.hash.substring(1);
      if (hash) {
        const navItem = document.querySelector(`.nav-item[onclick="showSection('${hash}')"]`);
        if (navItem) {
          navItem.click();
        }
      } else {
        showPlan();
      }
    });
  </script>
</body>
</html>

<!-- Forms Section (for saving/logging data and logout)
<div style="max-width: 500px; margin: 40px auto 0 auto;">
  <form method="POST" style="margin-bottom: 1.5rem;">
    <h2 style="color: var(--accent); margin-bottom: 1rem;">BMI Calculator</h2>
    <input type="number" name="weight" placeholder="Weight (kg)" step="0.1" required>
    <input type="number" name="height" placeholder="Height (cm)" step="0.1" required>
    <button type="submit" name="bmi_submit">Save BMI</button>
  </form>

  <form method="POST" style="margin-bottom: 1.5rem;">
    <h2 style="color: var(--accent); margin-bottom: 1rem;">Calorie Tracker</h2>
    <input type="number" name="age" placeholder="Age" required>
    <input type="number" name="c_weight" placeholder="Weight (kg)" step="0.1" required>
    <input type="number" name="c_height" placeholder="Height (cm)" step="0.1" required>
    <select name="activity" required>
      <option value="1.2">Sedentary</option>
      <option value="1.375">Lightly active</option>
      <option value="1.55">Moderately active</option>
      <option value="1.725">Very active</option>
      <option value="1.9">Extra active</option>
    </select>
    <button type="submit" name="calorie_submit">Save Calories</button>
  </form>

  <form method="POST" style="margin-bottom: 1.5rem;">
    <h2 style="color: var(--accent); margin-bottom: 1rem;">Exercise Log</h2>
    <input type="text" name="exercise" placeholder="Exercise Name" required>
    <input type="number" name="reps" placeholder="Reps" required>
    <input type="number" name="sets" placeholder="Sets" required>
    <button type="submit" name="exercise_submit">Log Exercise</button>
  </form>

  <form method="POST" style="margin-bottom: 1.5rem;">
    <h2 style="color: var(--accent); margin-bottom: 1rem;">Meal Log</h2>
    <input type="text" name="meal" placeholder="Meal Description" required>
    <button type="submit" name="meal_submit">Log Meal</button>
  </form>

  <form method="POST" style="margin-bottom: 1.5rem;">
    <h2 style="color: var(--accent); margin-bottom: 1rem;">Water Intake</h2>
    <input type="number" name="cups" placeholder="Cups of Water" required>
    <button type="submit" name="water_submit">Log Water</button>
  </form>

  <form action="{{ url_for('logout') }}">
    <button type="submit" style="background-color: #d63031; color: #fff;">Logout</button>
  </form>
</div> -->
    // Progress Chart Range Switcher
    function updateProgressChart() {
      const range = document.getElementById('progress-range').value;
      if (chart) {
        if (range === 'month') {
          chart.data.labels = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
          chart.data.datasets[0].data = [100, 140, 160, 190];
          chart.data.datasets[1].data = [80, 79, 77.5, 76];
        } else {
          chart.data.labels = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'];
          chart.data.datasets[0].data = [20, 25, 30, 35, 40];
          chart.data.datasets[1].data = [78.5, 78.4, 78.3, 78.2, 78.0];
        }
        chart.update();
      }
    }

    // Theme toggle
    function toggleTheme() {
      document.body.classList.toggle('light-mode');
      localStorage.setItem('fitzone-theme', document.body.classList.contains('light-mode') ? 'light' : 'dark');
    }

    document.addEventListener('DOMContentLoaded', () => {
      if (localStorage.getItem('fitzone-theme') === 'light') {
        document.body.classList.add('light-mode');
      }
    });